# Recommendation models

Recommendations that prove useful in [real-life situations](use_cases.md) are generated by using 
[scenario strategies](scenarios.md) that consist of algorithms.
Calculated results of an algorithm are called models. 
Models work in the background and are updated regularly to provide recommendations. 
Models come predefined with the software, based on the arrangements that you make with Ibexa.
You can request that a specific model is created by contacting customer support.

## Model types

There are several types of models available, however, the distinction between types is not visible in the user interface.

### Popularity models

Basic popularity recommendations, such as "Top purchased", "Top consumed" or "Top clicked". 
Models from this category return the most popular content items/products, based on a weighted overall 
usage history (recent events are more important) and category based filtering (bestsellers in selected category and/or subcategories).

### Collaborative models

#### Also clicked/purchased

This type of recommendation is often called "Collaborative Filtering based on user data" 
and is a proven approach to calculating recommendations. 
It recommends products which are usually clicked or purchased together. 
It is very simple to configure, needs no maintenance and it is a very powerful model.

#### Ultimately bought

This model combines click and buy events. 
In human readable form it could be something like "Users who looked for that kind of product finally bought this". 
It therefore provides a "matching factor" of searching and buying. 
This model suggests alternative products which customers bought after they clicked on the selected product. 
In contrast to the "also-bought" model it recommends products that are related but not purchased together. 
This model is the best choice to suggest alternative products for their search. 
For example, a user searches for a book which explains how to cut trees. 
If they find a book and on the book page this exact same book is being recommended, 
it means that several users interested in cutting trees bought this book (and not others), 
which hints that this book is the very best choice.

#### Frequently bought together / Bundle recommendations

Products that were bought in a combination for at least n times can be treated as bundles 
and recommended as a "package".
Based on the product which is currently shown, this model can recommend other products 
that fit exactly the one the user is currently looking at. 
A use case example could be:

A user wants to buy a smartphone and browses on the detail page of smartphone X. 
Apart from the "Also Clicked" recommendations, the recommendation engine could recommend the 
*Smartphone X + Smartphone X Cover + Headphones* bundle, because they were bought together 
in exactly this combination for at least five times.

It is not guaranteed that there's a bundle available for every product. 
Therefore, a rendering logic should display a box of bundle recommendations only 
if they are available.
Otherwise the box can be left out. 
The currently displayed product is always included in the bundle.

#### Similar rated

The similar rated algorithm provides recommendations based on user preferences. 
It predicts similar articles which the user will probably like and that will suit their interests. 
Recommendations for articles similar to their dislikes are suppressed.

#### Best rated

The best rated model provides recommendations based on algorithms that include the ranking values 
and the amount of distinct ratings. 
It is best suited for landing or category pages.

## Editorial and other models

#### Random

Semi-random products from the most recent ones. 
It allows injecting new products to the recommendation while the history based models 
are not yet able to recommend products based on the statistics. 
It is a really simplified and unsophisticated alternative if no other information is available 
to calculate and provide recommendations.

This model is not built based on the history footprints but based on the imported product catalog.

#### Editor-based

Products that are manually selected by a human. 
A customer can replace an automatically generated recommendation with a predefined list. 
It is best suited for cases when the store administrator wants to add special offers or sell stock remains. 
It could also be called "static recommendations".

#### Blacklist

Products on this list will never be recommended in any scenario. 
Usually test products or products that are used for system monitoring are placed on this list. 
Handle with care, because the blacklist model applies to all scenarios that exist in the system.

#### History based

Pseudo recommendation model to show the user products from his own history. 
Like "you have just watched" box.

## Advanced model configuration

Most of the models provide additional configuration parameters for customization. 

The parameters supported by the different types of models are described in the table below. 
Some models support [submodels](#submodels). 
Additional differentiation criterion is the supported context. 
If a model requires context, it can only be linked to scenarios that provide the necessary context.

|Model type|Available parameters|Submodel support|Context|
|---|---|---|---|
|Popularity|Relevant event history defines the time period for which the statistics must be analyzed. Dependent on the product type it can be between several months and several hours. Fast event ageing can be used to weight newer events higher than older events.|yes</br>submodels based on category are enabled by default|not needed|
|Also clicked/bought / Ultimately bought|Both also clicked and ultimately bought models allow to define the relevant event history.|yes, manual|required (either context items or user data)|
|Random|This model requires the maximum age for the items that should be recommended by this model.|no|not supported|
|History based|The type of the history (click-history or buy-history) must be specified.|no|required (user data)|
|Editor based|The list of recommendations must be created manually by the editor.|no|not supported|
|Blacklist|The list of items that should be excluded from the recommendations must be created manually by the editor.|no|not supported|

Do not confuse event history age with item age. 
History age is the age of the user's footprint (for example, "they clicked on the product A 
two weeks ago"). 
Item age is the time over which the item is available in the shop - so to say "how new is the item". 
The history is filled automatically over event tracking. 
The item catalog must be filled separately over an item import.
For more information about events, see [Event types](event_types.md).

## Submodels

Statistics-based recommendations often have the disadvantage of providing recommendations limited 
to the most popular, most suitable to the user, or most similar products. 
You might need to extend the set of available recommendations by defining a subset of 
items based on external criteria. 

Submodels give you the option to group products based on an attribute. 
Recommendations can then be requested specifically for the selected group.
For example:

- also bought clothing with the same color
- most popular toys for the predefined age
- also bought holiday presents with a predefined price

Submodels must be manually configured. 
You do this in the property dialog of the recommendation model.
After you configure the submodel, the results are generated overnight and are available on the next day.

### Nominal attributes

A nominal attribute based submodel works when the number of values of an attribute is relatively 
small and there is a large group of products for every value.
A good example would be garment colors in a clothing store. 
A bad example would be authors in a book store (there are too many of them).

When configuring submodels for a clothing store, you might want to get recommendations for a specific 
color, either predefined or a color of the context item. 
Similar colors can be grouped together, as shown below:

![Attribute example](img/attribute_example.png)

The following results are possible for the products shown in the diagram:

|Attribute from the recommendation request|Result|
|---|---|
|color=lime|Value "lime" is found in the first group. There are products in this group. If a model has any of them, they are recommended.|
|color=sand|Value "sand" is found in the fourth group. There are no products in the group, therefore nothing will be recommended by this model. The fallback model could be used if configured.|
|color=white|Value "white" cannot be found in any of groups. The main model is be used. Items from all submodel groups can appear in the result (as if the submodels were not configured at all).|
|no attribute specified|The main model is be used. The request is handled as if submodels were not configured at all. Products from the whole shop could appear in the recommendation list.|

### Numeric attributes

In numeric attribute based submodels you define subgroups by setting `from` and `to` limits for every group.

The logic used for resolving a submodel is as follows:

- The `from` value indicates the beginning of the range and is included in the subgroup.
- The `to` value indicates the end of the range end and is excluded from the subgroup.
  The **only exception** is the last of the ranges, where the `to` value is also included. 

!!! note

    You can specify a single or multiple attributes with multiple values for requesting recommendations. 
    Recommendation are fetched from all the submodels and merged based on the weight (relevance). 
    If one of the submodels delivers recommendations with better relevance, the results of other models can disappear from the list.

!!! tip

    Once configured, submodels are enabled for the model globally. 
    All the scenarios which use this model also use the submodel. 
    If you do not want to group recommendations based on a certain attribute, remove the attribute parameter from the request. 
    The submodel is then omitted.
